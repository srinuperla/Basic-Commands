1) SELECT
         TRANSACTION_TYPE,
 		 AMOUNT
   FROM   
         (SELECT TRANSACTION_TYPE, AMOUNT, ROW_NUMBER() OVER (PARTITION BY TRANSACTION_TYPE ORDER BY AMOUNT DESC)
		 TOP_VAL, ROW_NUMBER() OVER (PARTITION BY TRANSACTION_TYPE ORDER BY AMOUNT) BOTTOM_VAL)
		 WHERE TOP_VAL<=5 OR BOTTOM_VAL<=5;

2) SELECT
          D.NAME,
		  MAX(T.AMOUNT)
   FROM
          DEPARTMENT_DIM AS D
		  JOIN
		  TRANSACTION_LINE_FACT AS T 
	   ON D.KPI_DW_SKEY=T.KPI_DW_SKEY
 GROUP BY 
          T.TRANSACTION_TYPE,
          D.NAME
   HAVING 
          TRANSACTION_TYPE='SALES ORDER' OR TRANSACTION_TYPE='INVOICES';

4) SELECT
          L.CITY
	 FROM 
	      LOCATION_DIM L
		  JOIN
		  TRANSACTION_LINE_FACT F
		  ON F.KPI_DW_SKEY=L.KPI_DW_SKEY
	WHERE 
	      TRANSACTION_TYPE='SALES ORDER'
 ORDER BY 
          TRANSACTION_TYPE;

5) SELECT 
         TRANSACTION_TYPE,
		 AMOUNT, UNITS
	FROM 
	     TRANSACTION_LINE_FACT
GROUP BY TRANSACTION_TYPE, AMOUNT, UNITS
ORDER BY 1;

6) CREATE FORCE VIEW TARGET_VIEW AS SELECT T.TRANSACTION_ID, T.TRANSACTION_LINE_ID, T.TRANDATE, T.TRANSACTION_TYPE,
			I.TYPE_NAME, 
			L.CITY, 
			D.NAME, 
			CD.LIST_ITEM_NAME, 
			ID.ITEM_MERCH_DEPARTMENT_NA,
			ID.DESCRIPTION,
			IC.ITEM_MERCH_COLLECTION_NA,
			IC.DESCRIPTION,
			C.ITEM_MERCH_CLASS_NAME,
			C.DESCRIPTION,
			S.ITEM_MERCH_SUBCLASS_NAME,
			S.DESCRIPTION,
			T.AMOUNT,
			T.UNITS
			FROM TRANSACTION_LINE_FACT T JOIN ITEM_DIM I ON T.KPI_DW_SKEY = I.KPI_DW_SKEY
			JOIN LOCATION_DIM L ON I.KPI_DW_SKEY = L.KPI_DW_SKEY
			JOIN DEPARTMENT_DIM D ON L.KPI_DW_SKEY = D.KPI_DW_SKEY
			JOIN CHANNEL_DIM CD ON D.KPI_DW_SKEY = CD.KPI_DW_SKEY
			JOIN ITEM_MERCH_DEPARTMENT_DIM ID ON CD.KPI_DW_SKEY = ID.KPI_DW_SKEY
			JOIN ITEM_MERCH_COLLECTION_DIM IC ON ID.KPI_DW_SKEY = IC.KPI_DW_SKEY
			JOIN ITEM_MERCH_CLASS_DIM C ON IC.KPI_DW_SKEY = C.KPI_DW_SKEY
			JOIN ITEM_MERCH_SUBCLASS_DIM S ON C.KPI_DW_SKEY = S.KPI_DW_SKEY;
