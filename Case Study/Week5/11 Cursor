CREATE TABLE ITEM_DIM_FLAT(SKU VARCHAR(100),
             ITEM_TYPE VARCHAR(50),
			 BRAND VARCHAR(50),
			 MERCHANDISE_DEPARTMENT VARCHAR(50),
             MERCHANDISE_DEPT_NAME VARCHAR(50),
			 MERCHANDISE_COLLECTION VARCHAR(50),
			 MERCHANDISE_COLLECTION_NAME VARCHAR(50), 
             MERCHANDISE_CLASS VARCHAR(50),
             MERCHANDISE_CLASS_NAME VARCHAR(5),
			 MERCHANDISE_SUBCLASS VARCHAR(50),
			 MERCHANDISE_SUBCLASS_NAME VARCHAR(50),
			 KPI_ITEM_SKEY INT);

DECLARE 

CURSOR C1 IS SELECT 
                   I.SKU,
				   I.TYPE_NAME,
				   I.BRAND_NAME,
				   I.KPI_DW_SKEY,
				   D.DESCRIPTION,
				   D.ITEM_MERCHANDISE_DEPARTMENT_NA,
                   CL.DESCRIPTION,
				   CL.ITEM_MERCHANDISE_COLLECTION_NA,
				   C.DESCRIPTION,
				   C.ITEM_MERCHANDISE_CLASS_NAME, 
                   S.DESCRIPTION,
				   S.ITEM_MERCHANDISE_SUBCLASS_NAME
FROM
				   KPI_ITEM_DIM I JOIN KPI_ITEM_MERCHANDISE_DEPAR_DIM D 
				   ON I.KPI_DW_SKEY=D.KPI_DW_SKEY JOIN KPI_ITEM_MERCHANDISE_COL_DIM CL 
                   ON D.KPI_DW_SKEY=CL.KPI_DW_SKEY JOIN KPI_ITEM_MERCHANDISE_CLASS_DIM C 
                   ON CL.KPI_DW_SKEY=C.KPI_DW_SKEY JOIN KPI_ITEM_MERCHANDISE_SUBCL_DIM S 
				   ON C.KPI_DW_SKEY=S.KPI_DW_SKEY;
BEGIN
FOR CUR IN C1 LOOP
INSERT INTO ITEM_DIM_FLAT VALUES(C1.SKU,
                                 C1.ITEM_TYPE,
                                 C1.BRAND,C1.MERCHANDISE_DEPARTMENT,
								 C1.MERCHANDISE_DEPT_NAME,C1.MERCHANDISE_COLLECTION,
                                 C1.MERCHANDISE_COLLECTION_NAME,
								 C1.MERCHANDISE_CLASS,C1.MERCHANDISE_CLASS_NAME,
								 C1.MERCHANDISE_SUBCLASS,
								 C1.MERCHANDISE_SUBCLASS_NAME,
								 C1.KPI_ITEM_SKEY NUMBER)
(SELECT I.SKU,I.TYPE_NAME, I.BRAND_NAME,
                           I.KPI_DW_SKEY,
						   D.DESCRIPTION,
						   D.ITEM_MERCHANDISE_DEPARTMENT_NA,
						   CL.DESCRIPTION,CL.ITEM_MERCHANDISE_COLLECTION_NA,
                           C.DESCRIPTION,
						   C.ITEM_MERCHANDISE_CLASS_NAME,
						   S.DESCRIPTION,
						   S.ITEM_MERCHANDISE_SUBCLASS_NAME 
FROM 
					       KPI_ITEM_DIM I,
						   KPI_ITEM_MERCHANDISE_DEPAR_DIM 
                           D,KPI_ITEM_MERCHANDISE_COL_DIM CL,
						   KPI_ITEM_MERCHANDISE_CLASS_DIM C,
						   KPI_ITEM_MERCHANDISE_SUBCL_DIM S);
END LOOP;
CLOSE C1;
END;
